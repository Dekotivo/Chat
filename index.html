<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chat Persistente</title>
    <style>
        /* Los estilos anteriores se mantienen igual */
    </style>
</head>
<body>
    <!-- La misma estructura HTML anterior -->
    
    <script>
        // Cargar mensajes al iniciar
        window.onload = function() {
            loadMessages();
        };

        function loadMessages() {
            const chatHistory = document.getElementById('chatHistory');
            const messages = JSON.parse(localStorage.getItem('chatMessages') || '[]');
            
            messages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.innerHTML = `
                    <span>${msg.username}</span>
                    ${msg.content}
                    <div style="font-size: 0.8em; color: #666; margin-top: 5px;">
                        ${new Date(msg.timestamp).toLocaleTimeString()}
                    </div>
                `;
                chatHistory.appendChild(messageDiv);
            });
            
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function sendMessage() {
            const username = document.getElementById('username').value;
            const message = document.getElementById('message').value;
            
            if (!username) {
                alert('Por favor ingresa tu nombre');
                return;
            }

            if (!message) {
                alert('Por favor escribe un mensaje');
                return;
            }

            // Crear objeto de mensaje
            const newMessage = {
                username: username,
                content: message,
                timestamp: new Date().toISOString()
            };

            // Guardar en localStorage
            const messages = JSON.parse(localStorage.getItem('chatMessages') || '[]');
            messages.push(newMessage);
            localStorage.setItem('chatMessages', JSON.stringify(messages));

            // Actualizar la interfaz
            const chatHistory = document.getElementById('chatHistory');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.innerHTML = `
                <span>${username}</span>
                ${message}
                <div style="font-size: 0.8em; color: #666; margin-top: 5px;">
                    ${new Date().toLocaleTimeString()}
                </div>
            `;

            chatHistory.appendChild(messageDiv);
            document.getElementById('message').value = '';
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        // El resto del c√≥digo anterior se mantiene igual
    </script>
</body>
</html>
